---
title: "Assignment 2"
author: "Amy Ly"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dplyr)
library(ggrepel)
library(colorspace)
library(reshape2)

#install.packages("ggplot2movies")
library(ggplot2movies)

knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```

## Data Wrangling

```{r, include = FALSE}

movies <- na.omit(get(data(movies)))

genre <- rep(NA, nrow(movies)) 
#create an empty vector based on number of rows

count <- rowSums(movies[, 18:24])
genre[which(count > 1)] = "Mixed Genre"
genre[which(count < 1)] = "None"
genre[which(count == 1 & movies$Action == 1)] = "Action"
genre[which(count == 1 & movies$Animation == 1)] = "Animation"
genre[which(count == 1 & movies$Comedy == 1)] = "Comedy"
genre[which(count == 1 & movies$Drama == 1)] = "Drama"
genre[which(count == 1 & movies$Documentary == 1)] = "Documentary"
genre[which(count == 1 & movies$Romance == 1)] = "Romance"
genre[which(count == 1 & movies$Short == 1)] = "Short"
movies$genre<-as.factor(genre)

decade <- rep(NA, nrow(movies))
decade[which(movies$year>=2000)]="2000s"
decade[which(movies$year>=1990 & movies$year<2000)]="1990s"
decade[which(movies$year>=1980 & movies$year<1990)]="1980s"
decade[which(movies$year>=1970 & movies$year<1980)]="1970s"
decade[which(movies$year>=1960 & movies$year<1970)]="1960s"
decade[which(movies$year>=1950 & movies$year<1960)]="1950s"
decade[which(movies$year>=1940 & movies$year<1950)]="1940s"
decade[which(movies$year>=1930 & movies$year<1940)]="1930s"
decade[which(movies$year>=1920 & movies$year<1930)]="1920s"
decade[which(movies$year>=1910 & movies$year<1920)]="1910s"
decade[which(movies$year>=1900 & movies$year<1910)]="1900s"
movies$decade<-as.factor(decade)

budget_mil <- rep(0, nrow(movies))
movies$budget_mil<- movies$budget/1E6
#short format units for movies

df_80s <- movies %>% 
  filter(movies$year>=1980 & movies$year<1990) 

df_90s <- movies %>% 
  filter(movies$year>=1990 & movies$year<2000) 

df_00s <- movies %>% 
  filter(movies$year>=2000) 
  
dec_80s <- table(df_80s$genre) 
dec_90s <- table(df_90s$genre)
dec_00s <- table(df_00s$genre)

tab <- data.frame(rbind(dec_80s, dec_90s, dec_00s))

tab$decade <- c("1980s", "1990s", "2000s")

genre_prop <- movies %>% 
  group_by(decade) %>% 
    summarise(Action = mean(Action), 
              Animation = mean(Animation), 
              Comedy = mean(Comedy),
              Drama = mean(Comedy), 
              Documentary = mean(Documentary),
              Romance = mean(Romance),
              Short = mean(Short)) %>% 
    as.data.frame()

df_new <- movies %>% 
  group_by(decade, genre) %>% tally()

genre_melt <- melt(genre_prop, id.vars="decade")
colnames(genre_melt)[2] <- "Genre"

```

# Original Plot Critique

```{r, echo = FALSE}
ggplot(df_new, aes(x="", y=n, fill=genre))+ 
geom_bar(stat = "identity", position = position_fill())+
  geom_text(aes(x=1.6, label = n), position = position_fill(vjust = 0.5), size =2) +
#x = 1.6 shoves the text outside of the pie chart boundaries 
  coord_polar("y") +
  facet_wrap(~decade, nrow = 3)+
  theme(axis.text = element_blank(),
        axis.ticks = element_blank(),
        panel.grid  = element_blank(), 
        axis.title.x = element_blank(), 
        axis.title.y = element_blank()) +
   labs(title = "Number of Films made per Genre",
       caption = "There were very few genres and films made in the early 1900s\n Many films by the 2000s are of mixed genres.")

```

For my original plot, I used pie charts to show which movie genre became popular as time went on. The pie chart shows the relative counts of each genre out of the total for that year. The primary perceptual task is the perception of angle. It is also important to judge the data by the areas and arc lengths of the pie slices.

The original plot did not employ the easiest of perceptual tasks. It relied a lot on the area of pie charts (to
convey information about frequency) and colors (which conveyed information about what movie genre was being identified). These are some of the hardest perceptual tasks.

A possible improvement would be to compare the genres on a common scale and length. For example, utilizing a side by side bar chart so that the magnitude of
frequency of genres can be showcased and then have the position of the bars be on a common scale to allow for easy comparison. Another possible visualization would be to do a line chart showing the changes in proportion over the decades. 

The pie charts are faceted by decades and the only grouping that is utilized are different colors that represent genres. There was no particular meaning in the colors chosen. In hindsight, I should have chosen a color palette that was more colorblind friendly. 

To help colorblind people see my visualizations, I will improve the plot by using a palette that incoporates sequential gradient of hue and luminescence. To make it easier to differentiate trend lines, I will also include different geom_point symbols.

To abide by Gestalt's Law of Similarity, a possible improvement to color selection may be to use different shades to identify each slice within a group of particular genres. This may encourage people to compare slices of â€™s also encouraged to compare a group of slices to another group. 

If I were to visualize the data as a series of connected data points, then the trend of proportion for each genre over the decades would abide to Gestalt's Law of Connectedness and show that the data points are related to each other. However, I know there is a higher proportion of mixed genre films and it may be better to separate the genres and count them individually. Since there are 7 different genres, we will not be overwhelming anyone with too many groupings. 

In regards to the polishing of the original plot, it is not sufficient. The proportion text labels are difficult to read, a subtitle could have been added, and the caption did not include the source of the data. Since I plan on improving the visualization by using bar or line charts, I will also need to add on additional axis labels. 


## Improved Plot

```{r, echo = FALSE}
ggplot(genre_melt, aes(x=decade, y=value, color = Genre)) + 
  geom_line(aes(group = Genre)) + geom_point(aes(shape=Genre), size = 2.5)+ 
   labs(title = "The Proportion of Genres Produced Over Time",
       caption = "Movies were selected for inclusion if they had a known \n length and had been rated by at least one imdb user.")+
   scale_color_discrete_sequential(palette = "BurgYl")+
  xlab("Decade") + 
  ylab("Proportion")+
  theme_bw()

ggsave("improved_plot.png", height = 3, width = 8)
```


